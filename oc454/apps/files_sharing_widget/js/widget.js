/**
 * ownCloud - Picture Widget
 *
 * @author Sebastian Doell
 * @copyright 2012 Sebastian Doell <sebastian.doell ad libasys dot de>
 *
 *
 */
(function(){var i;var k=ownWidgetOptions;var b;var o;var e="";var r=true;var l=[];if(window.jQuery===undefined||window.jQuery.fn.jquery!=="1.8.2"){var m=document.createElement("script");m.setAttribute("type","text/javascript");m.setAttribute("src",k.path+"apps/files_sharing_widget/js/jquery-pack.min.js");if(m.readyState){m.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){q()}}}else{m.onload=q}(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(m)}else{i=window.jQuery;c()}function q(){i=window.jQuery.noConflict(true);c()}function h(t){t=(t+"").toString();return encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function n(){var t=b.height()-80;if(i("#albumPics").length>0){var t=b.height()-210}i("#ownWidget-slider").movingBoxes({reducedSize:1,startPanel:1,hashTags:false,speed:700,fixedHeight:true,wrap:false,buildNav:true,navFormatter:function(){return"&#9679;"},preinit:function(){b.prepend('<div id="ownWidget-Loader">&nbsp;</div>');i("#ownWidget-output").hide();i(".mb-wrapper").css({height:t})},initialized:function(w,v,u){i(".mb-scroll").height(t-20);i("#ownWidget-slider").height(t-20);i("#ownWidget-Loader").remove();i("#ownWidget-output").show()}})}function a(){i.ajax({dataType:"jsonp",jsonp:"jsonp_callback",url:k.path+"widget.php?iToken="+h(k.crypt)+e,success:function(t){i("#ownWidget-output").html("");i("#ownWidget-output").html(t.databack);i("#ownWidget-header").html(t.nav+" "+t.folder);if(i("#loginForm").length>0){i("#loginForm #iSubmit").click(function(u){u.preventDefault();e="&password="+i("#password").val();a()})}i("#ownWidget-header .loadAlbum").each(function(u,v){i(v).click(function(){if(i(v).attr("title")==""){e=""}else{e="&path=/"+i(v).attr("title")}a()})});if(r){b.css(k.cssAddWidget);if(!k.cssAddWidget.top&&!k.cssAddWidget.left){b.css({top:(i(window).height()/2)-(b.height()/2),left:(i(window).width()/2)-(b.width()/2)})}b.show();r=false}if(i("#ownWidget-slider").length>0){i("#ownWidget-slider").css({width:b.width()-12});i("#ownWidget-slider > div").css({width:b.width()-15});if(i("#ownWidget-slider > div").length>1){n()}else{if(i("#ownWidget-slider").html()==""){i("#ownWidget-slider").html("<div>No images found!</div>");i("#SlideShowButton").hide()}}}if(i("a[rel=fancyArea]").length>0){i("a[rel=fancyArea]").fancybox({transitionIn:"elastic",transitionOut:"elastic",speedIn:600,speedOut:200,titlePosition:"over",titleFormat:function(y,z,B,A){return'<span id="fancybox-title-over">Image '+(B+1)+" / "+z.length+" "+y+"</span>"}});i("#SlideShowButton").show()}}})}function d(){i.supersized.themeVars={progress_delay:false,thumb_page:false,thumb_interval:false,image_path:k.path+"apps/files_sharing_widget/img/",play_button:"#pauseplay",next_slide:"#nextslide",prev_slide:"#prevslide",next_thumb:"#nextthumb",prev_thumb:"#prevthumb",slide_caption:"#slidecaption",slide_current:".slidenumber",slide_total:".totalslides",slide_list:"#slide-list",thumb_tray:"#thumb-tray",thumb_list:"#thumb-list",thumb_forward:"#thumb-forward",thumb_back:"#thumb-back",tray_arrow:"#tray-arrow",tray_button:"#tray-button",progress_bar:"#progress-bar"}}function g(){var t='<div id="slideshow-content" style="display:none;"><div id="closeSlideShow">X</div><div id="prevthumb"></div><div id="nextthumb"></div>	<a id="prevslide" class="load-item"></a>	<a id="nextslide" class="load-item"></a>	<div id="thumb-tray" class="load-item"><div id="thumb-back"></div><div id="thumb-forward"></div></div>	<div id="progress-back" class="load-item"><div id="progress-bar"></div></div><div id="controls-wrapper" class="load-item"><div id="controls"><a id="play-button"><img id="pauseplay" src="'+k.path+'apps/files_sharing_widget/img/pause.png" /></a><div id="slidecounter"><span class="slidenumber"></span><span class="totalslides"></span></div><div id="slidecaption"></div><a id="tray-button"><img id="tray-arrow" src="'+k.path+'apps/files_sharing_widget/img/button-tray-up.png" /></a><ul id="slide-list"></ul></div></div></div>';i(t).appendTo("body");i("#closeSlideShow").click(function(){if(i.supersized.vars.slideshow_interval){clearInterval(i.supersized.vars.slideshow_interval)}l=[];i("#supersized-holder").remove();i("#slideshow-content").animate({opacity:"toggle"});i("#thumb-list").remove();b.animate({opacity:"toggle"})})}function p(){d();i.supersized({slideshow:1,autoplay:0,start_slide:1,stop_loop:0,random:0,slide_interval:3000,transition:6,transition_speed:1000,new_window:1,pause_hover:0,keyboard_nav:1,performance:1,image_protect:1,min_width:0,min_height:0,vertical_center:1,horizontal_center:1,fit_always:0,fit_portrait:1,fit_landscape:0,slide_links:false,new_window:false,thumb_links:1,thumbnail_navigation:0,slides:l,progress_bar:1,mouse_scrub:0})}function j(){if(k.display=="hidden"){var u=i('<div id="ownWidget-closeButton">X</div>');b.prepend(u)}b.prepend('<div id="ownWidget-output" class="jcarousel"></div>');var t=i('<div id="ownWidget-header"></div><div id="SlideShowButton">Slideshow</div>');b.prepend(t);i("#SlideShowButton").click(function(){b.animate({opacity:"toggle"},500,function(){i("body").append("<div id='supersized-holder'></div>");i("#supersized-loader").remove();i("#supersized").remove();i("#supersized-holder").append("<div id='supersized-loader'></div><ul id='supersized'></ul>");i("#supersized").show();i("#slideshow-content").animate({opacity:"toggle"});i("a[rel=fancyArea]").each(function(v,w){l.push({image:w.href,title:w.title.replace(/</,"&lt;").replace(/>/,"&gt;"),thumb:w.children[0].src})});p()})});i("#SlideShowButton").hide();if(k.display=="hidden"){u.click(function(){b.animate({opacity:"toggle"},500,function(){if(k.modal){o.height(0);o.width(0)}r=true;b.hide()})})}}function s(){b.hide();j();a();g()}function f(){b.hide();if(k.modal){o=i('<div id="ownWidget-overlayWid"></div>').appendTo("body")}j();var t=i('<div id="ownWidget-displayButton">'+k.buttonlabel+"</div>");t.css(k.cssAddButton);t.appendTo("body");t.click(function(){if(k.modal){o.height(i(window).height());o.width(i(window).width());o.animate({opacity:0.5},500,function(){a()})}else{a()}})}function c(){i(document).ready(function(t){b=t("#ownWidget-container");t("<link>",{rel:"stylesheet",type:"text/css",href:k.path+"apps/files_sharing_widget/css/widget.css"}).appendTo("head");if(k.display=="hidden"){f()}else{s()}})}})();